--DROP TABLE COUNTRY;
--DROP TABLE LEAGUE;
--DROP TABLE TEAM;
--DROP TABLE PLAYER;

CREATE TABLE COUNTRY (ID INTEGER PRIMARY KEY, NAME VARCHAR(200));
CREATE TABLE LEAGUE (ID INTEGER PRIMARY KEY, NAME VARCHAR(200), ID_COUNTRY INTEGER);
CREATE TABLE TEAM (ID INTEGER PRIMARY KEY, NAME VARCHAR(200), ID_LEAGUE INTEGER, FOUNDATION_YEAR INTEGER, GOALS_FOR INTEGER, GOALS_AGAINST INTEGER, POINTS INTEGER, LEVEL INTEGER);
CREATE TABLE PLAYER (ID INTEGER PRIMARY KEY, NAME VARCHAR(100), SURNAME VARCHAR(100), ID_TEAM INTEGER, ID_COUNTRY INTEGER, GOALS_FOR INTEGER);

INSERT INTO COUNTRY VALUES (1, 'Türkiye');

INSERT INTO LEAGUE VALUES (1, 'Süper Lig', 1);
INSERT INTO LEAGUE VALUES (2, '1. Lig', 1);

INSERT INTO TEAM VALUES (1, 'Galatasaray', 1, 1905, 60, 30, 80, 1);
INSERT INTO TEAM VALUES (2, 'Fenerbahçe', 1, 1907, 65, 25, 75, 1);
INSERT INTO TEAM VALUES (3, 'Beşiktaş', 1, 1903, 70, 20, 85, 1);
INSERT INTO TEAM VALUES (4, 'Trabzonspor', 1, 1967, 50, 35, 70, 1);
INSERT INTO TEAM VALUES (5, 'Kasımpaşa', 1, 1921, 50, 55, 30, 1);
INSERT INTO TEAM VALUES (6, 'Altay', 2, 1914, 60, 30, 80, 2);

INSERT INTO PLAYER VALUES (1, 'Arda', 'Turan', 1, 1, 10);
INSERT INTO PLAYER VALUES (2, 'Emre', 'Belözoğlu', 2, 1, 8);
INSERT INTO PLAYER VALUES (3, 'Cenk', 'Tosun', 3, 1, 12);
INSERT INTO PLAYER VALUES (4, 'Marek', 'Hamsik', 4, 1, 6);
INSERT INTO PLAYER VALUES (5, 'Marco', 'Paixão', 6, 5, 21);

SELECT * FROM LEAGUE WHERE ID_COUNTRY = (SELECT id FROM Country WHERE name = 'Türkiye');
SELECT * FROM TEAM WHERE id_league IN (SELECT id FROM LEAGUE WHERE id_country = (SELECT id FROM Country WHERE name = 'Türkiye'));
SELECT * FROM TEAM WHERE id_league IN (SELECT id FROM LEAGUE WHERE id_country = (SELECT id FROM Country WHERE name = 'Türkiye')) AND LEVEL = 1 ORDER BY POINTS DESC;
SELECT id_league, AVG(POINTS) AS AVERAGE_POINTS FROM TEAM WHERE id_league IN (SELECT id FROM LEAGUE WHERE id_country = (SELECT id FROM Country WHERE name = 'Türkiye')) GROUP BY id_league;
SELECT PL.NAME, PL.SURNAME FROM PLAYER PL WHERE PL.GOALS_FOR IN
(SELECT MAX(P.GOALS_FOR) AS NUMBER_OF_GOALS FROM PLAYER P JOIN TEAM T ON P.ID_TEAM = T.ID GROUP BY T.ID_LEAGUE);

SELECT * FROM TEAM WHERE GOALS_FOR < GOALS_AGAINST;
SELECT T.NAME, GOALS_FOR, (SELECT SUM(GOALS_FOR) FROM PLAYER P WHERE P.ID_TEAM = T.ID) FROM TEAM T;